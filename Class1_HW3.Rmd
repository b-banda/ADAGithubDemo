---
title: "Class1 Exercise"
author: "Bernard Banda"
date: "2024-08-28"
output: html_document
---

Opening packages

```{r}
# install.packages("pacman")
pacman::p_load(haven, readr, dplyr, openxlsx, ggplot2)
```

1.  Import class one survey data from our Github site (<https://github.com/kijohnson/ADA-2024>) (The dataset is called ‘Class 1 Survey Fall 2024_di.csv’), calling the R dataframe that you create C1survey.

```{r}
surveyFallData <-
 read_csv(
   "https://raw.githubusercontent.com/kijohnson/ADA-2024/main/Class%201%20(Getting%20started%20and%20RR%20I)/Lab/Class%201%20Survey%20Fall%202024_di.csv"
   )
```

2.  Determine: a. the number of observations (i.e. the number of people who filled out the survey) and b. the number of variables in the dataframe.

A = observations = 29

B = variables = 27

3.  Rename the column variables to something shorter and that is descriptive of what the variable is about (for example like_dogs for the ‘Do you like dogs?’ question variable) and b. Display that they are renamed.

```{r}

#use names function to rename the 27 variables in order

names(surveyFallData)[1:27]<-c("id", "like_cats", "like_dogs", "have_desert", "slogan",
"fav_day", "larkORowl", "fav_food", "fav_drink", "fav_season", "fav_month", "hobby",
"program", "specialization", "stat_software", "R_exp", "coding_comfort", "coding_length",
"top_three","public_health_interest", "fav_num", "bday", "bmonth", "country", "state",
"city", "highest_educ_level")

# create list of renamed variables in the object varlist
colnames(surveyFallData)

```

##### **4.** Write code to determine and display the number of factor, integer, numerical, and character variables there are in the *C1survey* dataset.

```{r}
# Determine the class of each variable in the dataset
variable_types <- sapply(surveyFallData, class)

# Count the number of each type of variable
num_factors <- sum(variable_types == "factor")
num_integers <- sum(variable_types == "integer")
num_numerical <- sum(variable_types == "numeric")  # This includes both integer and numeric
num_characters <- sum(variable_types == "character")

# Calculate the number of numerical (non-integer) variables
num_numerical_non_integer <- num_numerical - num_integers

# Display the counts
cat("Number of factor variables:", num_factors, "\n")
cat("Number of integer variables:", num_integers, "\n")
cat("Number of numerical (but not integer) variables:", num_numerical_non_integer, "\n")
cat("Number of character variables:", num_characters, "\n")

```

5.  **a. Using code, check the *bday* and *bmonth* variables for any unusual or missing values. If you find any,**

    ```{r}
    # Check the data type for bday and bmonth

    print(summary(surveyFallData$bday))
    print(summary(surveyFallData$bmonth))

    #check the structure of the bday and bmonth

    str(surveyFallData$bday)
    str(surveyFallData$bmonth)


    # Check for missing values in the 'bday and bmonth' variable
    missing_bday <- sum(is.na(surveyFallData$bday))
    missing_bmonth <- sum(is.na(surveyFallData$bmonth))

    print(missing_bday)
    print(missing_bmonth)
    ```

-   **Findings**: The following are the findings after checking the variables class, structure and missing values;

    -   Both bday and bmonth have character as a data type but these are should be numeric variable.

    -   The structure of the both bday and bmonth suggest that there are some month which are written as text instead of having numeric values (e.g September instead of 11).

    -   Check for missing values suggests that there are not missing values but the data needs to be cleaned and transformed from character to integer.

    **5 b. Describe what you will do with the unusual values in a comment before or immediately following the code that does it, and**

    ```{r}

    #Clean the text from number 

    # Replace specific text patterns in the 'bday' variable
    surveyFallData$bday <- gsub("March 31st", "31", surveyFallData$bday)
    surveyFallData$bday <- gsub("May 21-report 21", "21", surveyFallData$bday)

    # Replace specific text patterns in the 'bmonth' variable
    surveyFallData$bmonth <- gsub("March", "3", surveyFallData$bmonth)
    surveyFallData$bmonth <- gsub("September", "11", surveyFallData$bmonth)
    surveyFallData$bmonth <- gsub("February", "2", surveyFallData$bmonth)
    surveyFallData$bmonth <- gsub("May 21-report 5", "5", surveyFallData$bmonth)
    surveyFallData$bmonth <- gsub("July", "7", surveyFallData$bmonth)



    ```

    **5c. after you have cleaned up any unusual values, find the median bday and month. \*Note: please make sure that your bday and month variables are numeric before doing statistics.**

```{r}
#change the variable type from character to numeric

# Convert 'bday' to numeric
surveyFallData$bday <- as.numeric(surveyFallData$bday)

# Convert 'bmonth' to numeric
surveyFallData$bmonth <- as.numeric(surveyFallData$bmonth)

#Calculation the descriptive statistics for bday (min, median, mean and max)
print(summary(surveyFallData$bday))

#Calculation the descriptive statistics for bmonth (min, median, mean and max)
print(summary(surveyFallData$bmonth))
```

**Answer**s

-   Median bday = 14

-   Median bmonth = 7

\*\*Note; the minimum day can't be "0". This is a data error and the value needs to be cleaned by replacing "0" with the Mean or Median

6.  

    a.  Create a new variable called *bseason* that gives the season according to Northern Meteorological season in which respondents were born (winter = 12/1 to 2/29, spring = 3/1 to 5/31, summer = 6/1 to 8/31, fall = 9/1 to 11/30).

```{r}
# Create the 'bseason' variable based on 'bmonth' and 'bday'
surveyFallData$bseason <- with(surveyFallData, 
  ifelse((bmonth == 12 & bday >= 1) | (bmonth == 1) | (bmonth == 2), "Winter",
  ifelse((bmonth == 3 & bday >= 1) | (bmonth >= 4 & bmonth <= 5), "Spring",
  ifelse((bmonth == 6 & bday >= 1) | (bmonth >= 7 & bmonth <= 8), "Summer",
  ifelse((bmonth == 9 & bday >= 1) | (bmonth >= 10 & bmonth <= 11), "Fall", NA)))))

```

6.  b\. Using the table function, print a table of Seasons in the columns and bmonths in the rows that allows you to check that the coding is correct

```{r}
# Create a table of bmonths (rows) vs. bseason (columns)
season_table <- table(surveyFallData$bmonth, surveyFallData$bseason)

# Print the table to check the coding
print("Table of bmonths vs. bseason:")
print(season_table)

```

6.  c\. Sum the columns using the add margins function to answer the question of how many classmates were born in each season? Include your answer in the code.

    ```{r}
    # Sum the columns using the addmargins function to get the total for each season
    season_summary <- addmargins(season_table, margin = 2)

    # Print the summary with totals
    print("Summary table with the total number of births per season:")
    print(season_summary)

    ```

7.  Pick your favorite variable or variables to analyze, come up with a question you want to answer with that variable or variables, generate the code, and provide an answer to your question. Describe what you did using comments (i.e. #’s).

```{r}

# Reorder the levels of fav_day from Monday to Sunday
surveyFallData$fav_day <- factor(surveyFallData$fav_day, 
                                 levels = c("Sunday", "Saturday", "Friday", "Thursday", "Wednesday", "Tuesday", "Monday"))

# Create the bar chart on favourite days
ggplot(surveyFallData, aes(x = fav_day)) +
  geom_bar(fill = "Black") +
  coord_flip() +
  labs(title = "Bar Chart of Favourite Day") +
  theme_minimal()

```

**Interpretation**: The chart shows that Friday is the most favored day, with Saturday following behind. Monday and Sunday are the least preferred days among the respondents.
